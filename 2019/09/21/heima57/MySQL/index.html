<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="MySql数据库的基本概念1. 数据库的英文单词： DataBase 简称 ： DB 2. 什么数据库？     * 用于存储和管理数据的仓库。 3. 数据库的特点：     1. 持久化存储数据的。其实数据库就是一个文件系统     2. 方便存储和管理数据     3. 使用了统一的方式操作数据库 -- SQL 4. 常见的数据库软件     * 参见《MySQL基础.pdf》">
<meta name="keywords" content="数据库">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL">
<meta property="og:url" content="http://yoursite.com/2019/09/21/heima57/MySQL/index.html">
<meta property="og:site_name" content="guard warm">
<meta property="og:description" content="MySql数据库的基本概念1. 数据库的英文单词： DataBase 简称 ： DB 2. 什么数据库？     * 用于存储和管理数据的仓库。 3. 数据库的特点：     1. 持久化存储数据的。其实数据库就是一个文件系统     2. 方便存储和管理数据     3. 使用了统一的方式操作数据库 -- SQL 4. 常见的数据库软件     * 参见《MySQL基础.pdf》">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225181027-136224.bmp">
<meta property="og:image" content="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225182029-694089.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225182141-288535.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225182454-341727.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225183302-587709.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225183458-120425.png">
<meta property="og:updated_time" content="2020-02-25T14:13:03.869Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MySQL">
<meta name="twitter:description" content="MySql数据库的基本概念1. 数据库的英文单词： DataBase 简称 ： DB 2. 什么数据库？     * 用于存储和管理数据的仓库。 3. 数据库的特点：     1. 持久化存储数据的。其实数据库就是一个文件系统     2. 方便存储和管理数据     3. 使用了统一的方式操作数据库 -- SQL 4. 常见的数据库软件     * 参见《MySQL基础.pdf》">
<meta name="twitter:image" content="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225181027-136224.bmp">

<link rel="canonical" href="http://yoursite.com/2019/09/21/heima57/MySQL/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>MySQL | guard warm</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">guard warm</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">编程学习之路</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/21/heima57/MySQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="grandwarm">
      <meta itemprop="description" content="这些年编程路上踩得坑">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="guard warm">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-20 22:52:34" itemprop="dateCreated datePublished" datetime="2019-09-20T22:52:34Z">2019-09-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-02-25 14:13:03" itemprop="dateModified" datetime="2020-02-25T14:13:03Z">2020-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/heima57/" itemprop="url" rel="index"><span itemprop="name">heima57</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="MySql"><a href="#MySql" class="headerlink" title="MySql"></a>MySql</h1><h2 id="数据库的基本概念"><a href="#数据库的基本概念" class="headerlink" title="数据库的基本概念"></a>数据库的基本概念</h2><pre><code>1. 数据库的英文单词： DataBase 简称 ： DB
2. 什么数据库？
    * 用于存储和管理数据的仓库。
3. 数据库的特点：
    1. 持久化存储数据的。其实数据库就是一个文件系统
    2. 方便存储和管理数据
    3. 使用了统一的方式操作数据库 -- SQL
4. 常见的数据库软件
    * 参见《MySQL基础.pdf》</code></pre><a id="more"></a>

<h2 id="MySQL数据库软件"><a href="#MySQL数据库软件" class="headerlink" title="MySQL数据库软件"></a>MySQL数据库软件</h2><pre><code>1. 安装
    * 参见《MySQL基础.pdf》
2. 卸载
    1. 去mysql的安装目录找到my.ini文件
        * 复制 datadir=&quot;C:/ProgramData/MySQL/MySQL Server 5.5/Data/&quot;
    2. 卸载MySQL
    3. 删除C:/ProgramData目录下的MySQL文件夹。
3. 配置
    * MySQL服务启动
        1. 手动。
        2. cmd--&gt; services.msc 打开服务的窗口
        3. 使用管理员打开cmd
            * net start mysql : 启动mysql的服务
            * net stop mysql:关闭mysql服务
    * MySQL登录
        1. mysql -uroot -p密码
        2. mysql -hip -uroot -p连接目标的密码
        3. mysql --host=ip --user=root --password=连接目标的密码
    * MySQL退出
        1. exit
        2. quit

    * MySQL目录结构
        1. MySQL安装目录：basedir=&quot;D:/develop/MySQL/&quot;
            * 配置文件 my.ini
        2. MySQL数据目录：datadir=&quot;C:/ProgramData/MySQL/MySQL Server 5.5/Data/&quot;
            * 几个概念
                * 数据库：文件夹
                * 表：文件
                * 数据：数据</code></pre><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><pre><code>1.什么是SQL？
    Structured Query Language：结构化查询语言
    其实就是定义了操作所有关系型数据库的规则。每一种数据库操作的方式存在不一样的地方，称为“方言”。

2.SQL通用语法
    1. SQL 语句可以单行或多行书写，以分号结尾。
    2. 可使用空格和缩进来增强语句的可读性。
    3. MySQL 数据库的 SQL 语句不区分大小写，关键字建议使用大写。
    4. 3 种注释
        * 单行注释: -- 注释内容 或 # 注释内容(mysql 特有) 
        * 多行注释: /* 注释 */

3. SQL分类
    1) DDL(Data Definition Language)数据定义语言
        用来定义数据库对象：数据库，表，列等。关键字：create, drop,alter 等
    2) DML(Data Manipulation Language)数据操作语言
        用来对数据库中表的数据进行增删改。关键字：insert, delete, update 等
    3) DQL(Data Query Language)数据查询语言
        用来查询数据库中表的记录(数据)。关键字：select, where 等
    4) DCL(Data Control Language)数据控制语言(了解)
        用来定义数据库的访问权限和安全级别，及创建用户。关键字：GRANT， REVOKE 等</code></pre><p><img src="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225181027-136224.bmp" alt="SQL分类"></p>
<h3 id="DDL-操作数据库、表"><a href="#DDL-操作数据库、表" class="headerlink" title="DDL:操作数据库、表"></a>DDL:操作数据库、表</h3><h4 id="操作库"><a href="#操作库" class="headerlink" title="操作库"></a>操作库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">1. 操作数据库：CRUD</span><br><span class="line">	1. C(Create):创建</span><br><span class="line">		* 创建数据库：</span><br><span class="line">			* create database 数据库名称;</span><br><span class="line">		* 创建数据库，判断不存在，再创建：</span><br><span class="line">			* create database if not exists 数据库名称;</span><br><span class="line">		* 创建数据库，并指定字符集</span><br><span class="line">			* create database 数据库名称 character set 字符集名;</span><br><span class="line"></span><br><span class="line">		* 练习： 创建db4数据库，判断是否存在，并制定字符集为gbk</span><br><span class="line">			* create database if not exists db4 character set gbk;</span><br><span class="line">	2. R(Retrieve)：查询</span><br><span class="line">		* 查询所有数据库的名称:</span><br><span class="line">			* show databases;</span><br><span class="line">		* 查询某个数据库的字符集、某个数据库的创建语句</span><br><span class="line">			* show create database 数据库名称;</span><br><span class="line">	3. U(Update):修改</span><br><span class="line">		* 修改数据库的字符集</span><br><span class="line">			* alter database 数据库名称 character set 字符集名称;</span><br><span class="line">	4. D(Delete):删除</span><br><span class="line">		* 删除数据库</span><br><span class="line">			* drop database 数据库名称;</span><br><span class="line">		* 判断数据库存在，存在再删除</span><br><span class="line">			* drop database if exists 数据库名称;</span><br><span class="line">	5. 使用数据库</span><br><span class="line">		* 查询当前正在使用的数据库名称</span><br><span class="line">			* select database();</span><br><span class="line">		* 使用数据库</span><br><span class="line">			* use 数据库名称;</span><br></pre></td></tr></table></figure>

<h4 id="操作表"><a href="#操作表" class="headerlink" title="操作表"></a>操作表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">       1. C(Create):创建</span><br><span class="line">           1. 语法：</span><br><span class="line">               create table 表名(</span><br><span class="line">                   列名1 数据类型1,</span><br><span class="line">                   列名2 数据类型2,</span><br><span class="line">                   ....</span><br><span class="line">                   列名n 数据类型n</span><br><span class="line">               );</span><br><span class="line">               * 注意：最后一列，不需要加逗号（,）</span><br><span class="line">               * 数据库类型：</span><br><span class="line">                   1. int：整数类型</span><br><span class="line">                       * age int,</span><br><span class="line">                   2. double:小数类型</span><br><span class="line">                       * score double(5,2)</span><br><span class="line">                   3. date:日期，只包含年月日，yyyy-MM-dd</span><br><span class="line">                   4. datetime:日期，包含年月日时分秒	 yyyy-MM-dd HH:mm:ss</span><br><span class="line">                   5. timestamp:时间错类型	包含年月日时分秒	 yyyy-MM-dd HH:mm:ss	</span><br><span class="line">                       * 如果将来不给这个字段赋值，或赋值为null，则默认使用当前的系统时间，来自动赋值</span><br><span class="line">                   6. varchar：字符串</span><br><span class="line">                       * name varchar(20):姓名最大20个字符</span><br><span class="line">                       * zhangsan 8个字符  张三 2个字符</span><br><span class="line">               * 创建表</span><br><span class="line">                   create table student(</span><br><span class="line">                       id int,</span><br><span class="line">                       name varchar(32),</span><br><span class="line">                       age int ,</span><br><span class="line">                       score double(4,1),</span><br><span class="line">                       birthday date,</span><br><span class="line">                       insert_time timestamp</span><br><span class="line">                   );</span><br><span class="line">               * 复制表：</span><br><span class="line">                   * create table 表名 like 被复制的表名;	  	</span><br><span class="line">2. R(Retrieve)：查询</span><br><span class="line">	* 查询某个数据库中所有的表名称</span><br><span class="line">		* show tables;</span><br><span class="line">	* 查询表结构</span><br><span class="line">		* desc 表名;</span><br><span class="line">3. U(Update):修改</span><br><span class="line">	1. 修改表名</span><br><span class="line">		alter table 表名 rename to 新的表名;</span><br><span class="line">	2. 修改表的字符集</span><br><span class="line">		alter table 表名 character set 字符集名称;</span><br><span class="line">	3. 添加一列</span><br><span class="line">		alter table 表名 add 列名 数据类型;</span><br><span class="line">	4. 修改列名称 类型</span><br><span class="line">		alter table 表名 change 列名 新列名 新数据类型;</span><br><span class="line">		alter table 表名 modify 列名 新数据类型;</span><br><span class="line">	5. 删除列</span><br><span class="line">		alter table 表名 drop 列名;</span><br><span class="line">4. D(Delete):删除</span><br><span class="line">	* drop table 表名;</span><br><span class="line">	* drop table  if exists 表名 ;</span><br></pre></td></tr></table></figure>

<h5 id="添加约束"><a href="#添加约束" class="headerlink" title="添加约束"></a>添加约束</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">* 概念： 对表中的数据进行限定，保证数据的正确性、有效性和完整性。	</span><br><span class="line">* 分类：</span><br><span class="line">	1. 主键约束：primary key</span><br><span class="line">	2. 非空约束：not null</span><br><span class="line">	3. 唯一约束：unique</span><br><span class="line">	4. 外键约束：foreign key</span><br><span class="line"></span><br><span class="line">* 非空约束：not null，某一列的值不能为null</span><br><span class="line">	1. 创建表时添加约束</span><br><span class="line">		CREATE TABLE stu(</span><br><span class="line">			id INT,</span><br><span class="line">			NAME VARCHAR(20) NOT NULL -- name为非空</span><br><span class="line">		);</span><br><span class="line">	2. 创建表完后，添加非空约束</span><br><span class="line">		ALTER TABLE stu MODIFY NAME VARCHAR(20) NOT NULL;</span><br><span class="line"></span><br><span class="line">	3. 删除name的非空约束</span><br><span class="line">		ALTER TABLE stu MODIFY NAME VARCHAR(20);</span><br><span class="line"></span><br><span class="line">* 唯一约束：unique，某一列的值不能重复</span><br><span class="line">	1. 注意：</span><br><span class="line">		* 唯一约束可以有NULL值，但是只能有一条记录为null</span><br><span class="line">	2. 在创建表时，添加唯一约束</span><br><span class="line">		CREATE TABLE stu(</span><br><span class="line">			id INT,</span><br><span class="line">			phone_number VARCHAR(20) UNIQUE -- 手机号</span><br><span class="line">		);</span><br><span class="line">	3. 删除唯一约束</span><br><span class="line">		ALTER TABLE stu DROP INDEX phone_number;</span><br><span class="line">	4. 在表创建完后，添加唯一约束</span><br><span class="line">		ALTER TABLE stu MODIFY phone_number VARCHAR(20) UNIQUE;</span><br><span class="line"></span><br><span class="line">* 主键约束：primary key。</span><br><span class="line">	1. 注意：</span><br><span class="line">		1. 含义：非空且唯一</span><br><span class="line">		2. 一张表只能有一个字段为主键</span><br><span class="line">		3. 主键就是表中记录的唯一标识</span><br><span class="line"></span><br><span class="line">	2. 在创建表时，添加主键约束</span><br><span class="line">		create table stu(</span><br><span class="line">			id int primary key,-- 给id添加主键约束</span><br><span class="line">			name varchar(20)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	3. 删除主键</span><br><span class="line">		-- 错误 alter table stu modify id int ;</span><br><span class="line">		ALTER TABLE stu DROP PRIMARY KEY;</span><br><span class="line"></span><br><span class="line">	4. 创建完表后，添加主键</span><br><span class="line">		ALTER TABLE stu MODIFY id INT PRIMARY KEY;</span><br><span class="line"></span><br><span class="line">	5. 自动增长：</span><br><span class="line">		1.  概念：如果某一列是数值类型的，使用 auto_increment 可以来完成值得自动增长</span><br><span class="line"></span><br><span class="line">		2. 在创建表时，添加主键约束，并且完成主键自增长</span><br><span class="line">		create table stu(</span><br><span class="line">			id int primary key auto_increment,-- 给id添加主键约束</span><br><span class="line">			name varchar(20)</span><br><span class="line">		);</span><br><span class="line">		3. 删除自动增长</span><br><span class="line">		ALTER TABLE stu MODIFY id INT;</span><br><span class="line">		4. 添加自动增长</span><br><span class="line">		ALTER TABLE stu MODIFY id INT AUTO_INCREMENT;</span><br><span class="line">* 外键约束：foreign key,让表于表产生关系，从而保证数据的正确性。</span><br><span class="line">	1. 在创建表时，可以添加外键</span><br><span class="line">		* 语法：</span><br><span class="line">			create table 表名(</span><br><span class="line">				....</span><br><span class="line">				外键列</span><br><span class="line">				constraint 外键名称 foreign key (外键列名称) references 主表名称(主表列名称)</span><br><span class="line">			);</span><br><span class="line"></span><br><span class="line">	2. 删除外键</span><br><span class="line">		ALTER TABLE 表名 DROP FOREIGN KEY 外键名称;</span><br><span class="line"></span><br><span class="line">	3. 创建表之后，添加外键</span><br><span class="line">		ALTER TABLE 表名 ADD CONSTRAINT 外键名称 </span><br><span class="line">		FOREIGN KEY (外键字段名称) REFERENCES 主表名称(主表列名称);</span><br><span class="line">	4. 级联操作</span><br><span class="line">		1. 添加级联操作</span><br><span class="line">			语法：ALTER TABLE 表名 ADD CONSTRAINT 外键名称 </span><br><span class="line">					FOREIGN KEY (外键字段名称) REFERENCES 主表名称(主表列名称) </span><br><span class="line">					ON UPDATE CASCADE ON DELETE CASCADE  ;</span><br><span class="line">		2. 分类：</span><br><span class="line">			1. 级联更新：ON UPDATE CASCADE </span><br><span class="line">			2. 级联删除：ON DELETE CASCADE 	添加需谨慎</span><br></pre></td></tr></table></figure>

<h3 id="DML：增删改表中数据"><a href="#DML：增删改表中数据" class="headerlink" title="DML：增删改表中数据"></a>DML：增删改表中数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1. 添加数据：</span><br><span class="line">	* 语法：</span><br><span class="line">		* insert into 表名(列名1,列名2,...列名n) values(值1,值2,...值n);</span><br><span class="line">	* 注意：</span><br><span class="line">		1. 列名和值要一一对应。</span><br><span class="line">		2. 如果表名后，不定义列名，则默认给所有列添加值</span><br><span class="line">			insert into 表名 values(值1,值2,...值n);</span><br><span class="line">		3. 除了数字类型，其他类型需要使用引号(单双都可以)引起来</span><br><span class="line">2. 删除数据：</span><br><span class="line">	* 语法：</span><br><span class="line">		* delete from 表名 [where 条件]</span><br><span class="line">	* 注意：</span><br><span class="line">		1. 如果不加条件，则删除表中所有记录。</span><br><span class="line">		2. 如果要删除所有记录</span><br><span class="line">			1. delete from 表名; -- 不推荐使用。有多少条记录就会执行多少次删除操作</span><br><span class="line">			2. TRUNCATE TABLE 表名; -- 推荐使用，效率更高 先删除表，然后再创建一张一样的表。</span><br><span class="line">3. 修改数据：</span><br><span class="line">	* 语法：</span><br><span class="line">		* update 表名 set 列名1 = 值1, 列名2 = 值2,... [where 条件];</span><br><span class="line"></span><br><span class="line">	* 注意：</span><br><span class="line">		1. 如果不加任何条件，则会将表中所有记录全部修改。</span><br></pre></td></tr></table></figure>

<h3 id="DQL：查询表中的记录"><a href="#DQL：查询表中的记录" class="headerlink" title="DQL：查询表中的记录"></a>DQL：查询表中的记录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">1. 语法：</span><br><span class="line">	select</span><br><span class="line">		字段列表</span><br><span class="line">	from</span><br><span class="line">		表名列表</span><br><span class="line">	where</span><br><span class="line">		条件列表</span><br><span class="line">	group by</span><br><span class="line">		分组字段</span><br><span class="line">	having</span><br><span class="line">		分组之后的条件</span><br><span class="line">	order by</span><br><span class="line">		排序</span><br><span class="line">	limit</span><br><span class="line">		分页限定</span><br><span class="line">2. 基础查询</span><br><span class="line">	1. 多个字段的查询</span><br><span class="line">		select 字段名1，字段名2... from 表名；</span><br><span class="line">		* 注意：</span><br><span class="line">			* 如果查询所有字段，则可以使用*来替代字段列表，但不推荐使用</span><br><span class="line">	2. 去除重复：</span><br><span class="line">		* distinct</span><br><span class="line">	3. 计算列</span><br><span class="line">		* 一般可以使用四则运算计算一些列的值。（一般只会进行数值型的计算）</span><br><span class="line">		* ifnull(表达式1,表达式2)：null参与的运算，计算结果都为null</span><br><span class="line">			* 表达式1：哪个字段需要判断是否为null</span><br><span class="line">			* 如果该字段为null后的替换值。</span><br><span class="line">	4. 起别名：</span><br><span class="line">		* as：as也可以省略</span><br><span class="line">3. 条件查询</span><br><span class="line">	1. where子句后跟条件</span><br><span class="line">	2. 运算符</span><br><span class="line">		* &gt; 、&lt; 、&lt;= 、&gt;= 、= 、&lt;&gt;</span><br><span class="line">		* BETWEEN...AND  </span><br><span class="line">		* IN( 集合) </span><br><span class="line">		* LIKE：模糊查询</span><br><span class="line">			* 占位符：</span><br><span class="line">				* _:单个任意字符</span><br><span class="line">				* %：多个任意字符</span><br><span class="line">		* IS NULL  </span><br><span class="line">		* and  或 &amp;&amp;</span><br><span class="line">		* or  或 || </span><br><span class="line">		* not  或 !</span><br><span class="line">		</span><br><span class="line">			-- 查询年龄大于等于20 小于等于30</span><br><span class="line">			SELECT * FROM student WHERE age &gt;= 20 AND  age &lt;=30;</span><br><span class="line">			SELECT * FROM student WHERE age BETWEEN 20 AND 30;</span><br><span class="line">			</span><br><span class="line">			-- 查询年龄22岁，18岁，25岁的信息</span><br><span class="line">			SELECT * FROM student WHERE age = 22 OR age = 18 OR age = 25</span><br><span class="line">			SELECT * FROM student WHERE age IN (22,18,25);</span><br><span class="line">			</span><br><span class="line">			-- 查询英语成绩为null</span><br><span class="line">			SELECT * FROM student WHERE english = NULL; -- null值不能使用 = （!=） 判断</span><br><span class="line">			SELECT * FROM student WHERE english IS NULL;</span><br><span class="line">			</span><br><span class="line">			-- 查询英语成绩不为null</span><br><span class="line">			SELECT * FROM student WHERE english  IS NOT NULL;</span><br><span class="line">			</span><br><span class="line">			-- 查询姓马的有哪些？ like</span><br><span class="line">			SELECT * FROM student WHERE NAME LIKE &apos;马%&apos;;</span><br><span class="line">			-- 查询姓名第二个字是化的人</span><br><span class="line">			SELECT * FROM student WHERE NAME LIKE &quot;_化%&quot;;	</span><br><span class="line">			-- 查询姓名是3个字的人</span><br><span class="line">			SELECT * FROM student WHERE NAME LIKE &apos;___&apos;;</span><br><span class="line">			-- 查询姓名中包含德的人</span><br><span class="line">			SELECT * FROM student WHERE NAME LIKE &apos;%德%&apos;;</span><br></pre></td></tr></table></figure>

<h4 id="复杂查询"><a href="#复杂查询" class="headerlink" title="复杂查询"></a>复杂查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">1. 排序查询</span><br><span class="line">	* 语法：order by 子句</span><br><span class="line">		* order by 排序字段1 排序方式1 ，  排序字段2 排序方式2...</span><br><span class="line">	* 排序方式：</span><br><span class="line">		* ASC：升序，默认的。</span><br><span class="line">		* DESC：降序。</span><br><span class="line">	* 注意：</span><br><span class="line">		* 如果有多个排序条件，则当前边的条件值一样时，才会判断第二条件。</span><br><span class="line">2. 聚合函数：将一列数据作为一个整体，进行纵向的计算。</span><br><span class="line">	1. count：计算个数</span><br><span class="line">		1. 一般选择非空的列：主键</span><br><span class="line">		2. count(*)</span><br><span class="line">	2. max：计算最大值</span><br><span class="line">	3. min：计算最小值</span><br><span class="line">	4. sum：计算和</span><br><span class="line">	5. avg：计算平均值</span><br><span class="line">	* 注意：聚合函数的计算，排除null值。</span><br><span class="line">		解决方案：</span><br><span class="line">			1. 选择不包含非空的列进行计算</span><br><span class="line">			2. IFNULL函数</span><br><span class="line"></span><br><span class="line">3. 分组查询:</span><br><span class="line">	1. 语法：group by 分组字段；</span><br><span class="line">	2. 注意：</span><br><span class="line">		1. 分组之后查询的字段：分组字段、聚合函数</span><br><span class="line">		2. where 和 having 的区别？</span><br><span class="line">			1. where 在分组之前进行限定，如果不满足条件，则不参与分组。</span><br><span class="line">			   having在分组之后进行限定，如果不满足结果，则不会被查询出来</span><br><span class="line">			2. where 后不可以跟聚合函数，having可以进行聚合函数的判断。</span><br><span class="line"></span><br><span class="line">		-- 按照性别分组。分别查询男、女同学的平均分</span><br><span class="line">		SELECT sex , AVG(math) FROM student GROUP BY sex;</span><br><span class="line">		</span><br><span class="line">		-- 按照性别分组。分别查询男、女同学的平均分,人数</span><br><span class="line">		SELECT sex , AVG(math),COUNT(id) FROM student GROUP BY sex;</span><br><span class="line">		</span><br><span class="line">		--  按照性别分组。分别查询男、女同学的平均分,人数 要求：分数低于70分的人，不参与分组</span><br><span class="line">		SELECT sex , AVG(math),COUNT(id) FROM student WHERE math &gt; 70 GROUP BY sex;</span><br><span class="line">		</span><br><span class="line">		--  按照性别分组。分别查询男、女同学的平均分,人数 要求：分数低于70分的人，不参与分组,</span><br><span class="line">		--  分组之后。人数要大于2个人</span><br><span class="line">		SELECT sex , AVG(math),COUNT(id) FROM student </span><br><span class="line">		WHERE math &gt; 70 GROUP BY sex HAVING COUNT(id) &gt; 2;</span><br><span class="line">		</span><br><span class="line">		SELECT sex , AVG(math),COUNT(id) 人数 FROM student </span><br><span class="line">		WHERE math &gt; 70 GROUP BY sex HAVING 人数 &gt; 2;</span><br><span class="line">4. 分页查询</span><br><span class="line">	1. 语法：limit 开始的索引,每页查询的条数;</span><br><span class="line">	2. 公式：开始的索引 = （当前的页码 - 1） * 每页显示的条数</span><br><span class="line">		-- 每页显示3条记录 </span><br><span class="line"></span><br><span class="line">		SELECT * FROM student LIMIT 0,3; -- 第1页</span><br><span class="line">		</span><br><span class="line">		SELECT * FROM student LIMIT 3,3; -- 第2页</span><br><span class="line">		</span><br><span class="line">		SELECT * FROM student LIMIT 6,3; -- 第3页</span><br><span class="line"></span><br><span class="line">	3. limit 是一个MySQL&quot;方言&quot;</span><br></pre></td></tr></table></figure>

<h4 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">* 查询语法：</span><br><span class="line">	select</span><br><span class="line">		列名列表</span><br><span class="line">	from</span><br><span class="line">		表名列表</span><br><span class="line">	where....</span><br><span class="line">* 笛卡尔积：</span><br><span class="line">	* 有两个集合A,B .取这两个集合的所有组成情况。</span><br><span class="line">	* 要完成多表查询，需要消除无用的数据</span><br><span class="line">* 多表查询的分类：</span><br><span class="line">	1. 内连接查询：</span><br><span class="line">		1. 隐式内连接：使用where条件消除无用数据			</span><br><span class="line">			-- 查询员工表的名称，性别。部门表的名称</span><br><span class="line">			SELECT </span><br><span class="line">				t1.name, -- 员工表的姓名</span><br><span class="line">				t1.gender,-- 员工表的性别</span><br><span class="line">				t2.name -- 部门表的名称</span><br><span class="line">			FROM</span><br><span class="line">				emp t1,</span><br><span class="line">				dept t2</span><br><span class="line">			WHERE </span><br><span class="line">				t1.`dept_id` = t2.`id`;</span><br><span class="line">		2. 显式内连接：</span><br><span class="line">			* 语法： select 字段列表 from 表名1 [inner] join 表名2 on 条件</span><br><span class="line">			* 例如：</span><br><span class="line">				* SELECT * FROM emp INNER JOIN dept ON emp.`dept_id` = dept.`id`;	</span><br><span class="line">				* SELECT * FROM emp JOIN dept ON emp.`dept_id` = dept.`id`;	</span><br><span class="line">	2. 外链接查询：</span><br><span class="line">		1. 左外连接：</span><br><span class="line">			* 语法：select 字段列表 from 表1 left [outer] join 表2 on 条件；</span><br><span class="line">			* 查询的是左表所有数据以及其交集部分</span><br><span class="line">			* 例子：</span><br><span class="line">				-- 查询所有员工信息，如果员工有部门，则查询部门名称，没有部门，则不显示部门名称</span><br><span class="line">				SELECT 	t1.*,t2.`name` FROM emp t1 LEFT JOIN dept t2 </span><br><span class="line">				ON t1.`dept_id` = t2.`id`;</span><br><span class="line">		2. 右外连接：</span><br><span class="line">			* 语法：select 字段列表 from 表1 right [outer] join 表2 on 条件；</span><br><span class="line">			* 查询的是右表所有数据以及其交集部分---右表+与左表符合条件的交集</span><br><span class="line">			* 例子：</span><br><span class="line">				SELECT 	* FROM dept t2 RIGHT JOIN emp t1 ON t1.`dept_id` = t2.`id`;</span><br><span class="line">	3. 子查询：</span><br><span class="line">		* 概念：查询中嵌套查询，称嵌套查询为子查询。</span><br><span class="line">		* 子查询不同情况</span><br><span class="line">			1. 子查询的结果是单行单列的：</span><br><span class="line">				* 子查询可以作为条件，使用运算符去判断。 运算符： &gt; &gt;= &lt; &lt;= =</span><br><span class="line">				-- 查询员工工资小于平均工资的人</span><br><span class="line">				SELECT * FROM emp WHERE emp.salary &lt; (SELECT AVG(salary) FROM emp);</span><br><span class="line">			2. 子查询的结果是多行单列的：</span><br><span class="line">				* 子查询可以作为条件，使用运算符in来判断</span><br><span class="line">				-- 查询&apos;财务部&apos;和&apos;市场部&apos;所有的员工信息</span><br><span class="line">				SELECT id FROM dept WHERE NAME = &apos;财务部&apos; OR NAME = &apos;市场部&apos;;</span><br><span class="line">				SELECT * FROM emp WHERE dept_id = 3 OR dept_id = 2;</span><br><span class="line">				-- 子查询</span><br><span class="line">				SELECT * FROM emp WHERE dept_id IN (SELECT id FROM dept </span><br><span class="line">                       	 WHERE NAME = &apos;财务部&apos; OR NAME = &apos;市场部&apos;);</span><br><span class="line"></span><br><span class="line">			3. 子查询的结果是多行多列的：</span><br><span class="line">				* 子查询可以作为一张虚拟表参与查询</span><br><span class="line">				-- 查询员工入职日期是2011-11-11日之后的员工信息和部门信息</span><br><span class="line">				-- 子查询</span><br><span class="line">				SELECT * </span><br><span class="line">				FROM dept t1 ,(SELECT * FROM emp WHERE emp.`join_date` &gt; &apos;2011-11-11&apos;) t2</span><br><span class="line">				WHERE t1.id = t2.dept_id;</span><br><span class="line">				</span><br><span class="line">				-- 普通内连接</span><br><span class="line">				SELECT * FROM emp t1,dept t2 </span><br><span class="line">				WHERE t1.`dept_id` = t2.`id` AND t1.`join_date` &gt;  &apos;2011-11-11&apos;</span><br></pre></td></tr></table></figure>

<h5 id="多表查询练习"><a href="#多表查询练习" class="headerlink" title="多表查询练习"></a>多表查询练习</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line">-- 部门表</span><br><span class="line">CREATE TABLE dept (</span><br><span class="line">  id INT PRIMARY KEY PRIMARY KEY, -- 部门id</span><br><span class="line">  dname VARCHAR(50), -- 部门名称</span><br><span class="line">  loc VARCHAR(50) -- 部门所在地</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加4个部门</span><br><span class="line">INSERT INTO dept(id,dname,loc) VALUES </span><br><span class="line">(10,&apos;教研部&apos;,&apos;北京&apos;),</span><br><span class="line">(20,&apos;学工部&apos;,&apos;上海&apos;),</span><br><span class="line">(30,&apos;销售部&apos;,&apos;广州&apos;),</span><br><span class="line">(40,&apos;财务部&apos;,&apos;深圳&apos;);</span><br><span class="line">-- 职务表，职务名称，职务描述</span><br><span class="line">CREATE TABLE job (</span><br><span class="line">  id INT PRIMARY KEY,</span><br><span class="line">  jname VARCHAR(20),</span><br><span class="line">  description VARCHAR(50)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加4个职务</span><br><span class="line">INSERT INTO job (id, jname, description) VALUES</span><br><span class="line">(1, &apos;董事长&apos;, &apos;管理整个公司，接单&apos;),</span><br><span class="line">(2, &apos;经理&apos;, &apos;管理部门员工&apos;),</span><br><span class="line">(3, &apos;销售员&apos;, &apos;向客人推销产品&apos;),</span><br><span class="line">(4, &apos;文员&apos;, &apos;使用办公软件&apos;);</span><br><span class="line">-- 员工表</span><br><span class="line">CREATE TABLE emp (</span><br><span class="line">  id INT PRIMARY KEY, -- 员工id</span><br><span class="line">  ename VARCHAR(50), -- 员工姓名</span><br><span class="line">  job_id INT, -- 职务id</span><br><span class="line">  mgr INT , -- 上级领导</span><br><span class="line">  joindate DATE, -- 入职日期</span><br><span class="line">  salary DECIMAL(7,2), -- 工资</span><br><span class="line">  bonus DECIMAL(7,2), -- 奖金</span><br><span class="line">  dept_id INT, -- 所在部门编号</span><br><span class="line">  CONSTRAINT emp_jobid_ref_job_id_fk FOREIGN KEY (job_id) REFERENCES job (id),</span><br><span class="line">  CONSTRAINT emp_deptid_ref_dept_id_fk FOREIGN KEY (dept_id) REFERENCES dept (id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加员工</span><br><span class="line">INSERT INTO emp(id,ename,job_id,mgr,joindate,salary,bonus,dept_id) VALUES </span><br><span class="line">(1001,&apos;孙悟空&apos;,4,1004,&apos;2000-12-17&apos;,&apos;8000.00&apos;,NULL,20),</span><br><span class="line">(1002,&apos;卢俊义&apos;,3,1006,&apos;2001-02-20&apos;,&apos;16000.00&apos;,&apos;3000.00&apos;,30),</span><br><span class="line">(1003,&apos;林冲&apos;,3,1006,&apos;2001-02-22&apos;,&apos;12500.00&apos;,&apos;5000.00&apos;,30),</span><br><span class="line">(1004,&apos;唐僧&apos;,2,1009,&apos;2001-04-02&apos;,&apos;29750.00&apos;,NULL,20),</span><br><span class="line">(1005,&apos;李逵&apos;,4,1006,&apos;2001-09-28&apos;,&apos;12500.00&apos;,&apos;14000.00&apos;,30),</span><br><span class="line">(1006,&apos;宋江&apos;,2,1009,&apos;2001-05-01&apos;,&apos;28500.00&apos;,NULL,30),</span><br><span class="line">(1007,&apos;刘备&apos;,2,1009,&apos;2001-09-01&apos;,&apos;24500.00&apos;,NULL,10),</span><br><span class="line">(1008,&apos;猪八戒&apos;,4,1004,&apos;2007-04-19&apos;,&apos;30000.00&apos;,NULL,20),</span><br><span class="line">(1009,&apos;罗贯中&apos;,1,NULL,&apos;2001-11-17&apos;,&apos;50000.00&apos;,NULL,10),</span><br><span class="line">(1010,&apos;吴用&apos;,3,1006,&apos;2001-09-08&apos;,&apos;15000.00&apos;,&apos;0.00&apos;,30),</span><br><span class="line">(1011,&apos;沙僧&apos;,4,1004,&apos;2007-05-23&apos;,&apos;11000.00&apos;,NULL,20),</span><br><span class="line">(1012,&apos;李逵&apos;,4,1006,&apos;2001-12-03&apos;,&apos;9500.00&apos;,NULL,30),</span><br><span class="line">(1013,&apos;小白龙&apos;,4,1004,&apos;2001-12-03&apos;,&apos;30000.00&apos;,NULL,20),</span><br><span class="line">(1014,&apos;关羽&apos;,4,1007,&apos;2002-01-23&apos;,&apos;13000.00&apos;,NULL,10);</span><br><span class="line">-- 工资等级表</span><br><span class="line">CREATE TABLE salarygrade (</span><br><span class="line">  grade INT PRIMARY KEY,   -- 级别</span><br><span class="line">  losalary INT,  -- 最低工资</span><br><span class="line">  hisalary INT -- 最高工资</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加5个工资等级</span><br><span class="line">INSERT INTO salarygrade(grade,losalary,hisalary) VALUES </span><br><span class="line">(1,7000,12000),</span><br><span class="line">(2,12010,14000),</span><br><span class="line">(3,14010,20000),</span><br><span class="line">(4,20010,30000),</span><br><span class="line">(5,30010,99990);</span><br><span class="line"></span><br><span class="line">-- 需求：</span><br><span class="line"></span><br><span class="line">-- 1.查询所有员工信息。查询员工编号，员工姓名，工资，职务名称，职务描述</span><br><span class="line">/*</span><br><span class="line">	分析：</span><br><span class="line">		1.员工编号，员工姓名，工资，需要查询emp表  职务名称，职务描述 需要查询job表</span><br><span class="line">		2.查询条件 emp.job_id = job.id</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line">SELECT </span><br><span class="line">	t1.`id`, -- 员工编号</span><br><span class="line">	t1.`ename`, -- 员工姓名</span><br><span class="line">	t1.`salary`,-- 工资</span><br><span class="line">	t2.`jname`, -- 职务名称</span><br><span class="line">	t2.`description` -- 职务描述</span><br><span class="line">FROM </span><br><span class="line">	emp t1, job t2</span><br><span class="line">WHERE </span><br><span class="line">	t1.`job_id` = t2.`id`;</span><br><span class="line">-- 2.查询员工编号，员工姓名，工资，职务名称，职务描述，部门名称，部门位置</span><br><span class="line">SELECT </span><br><span class="line">	t1.`id`, -- 员工编号</span><br><span class="line">	t1.`ename`, -- 员工姓名</span><br><span class="line">	t1.`salary`,-- 工资</span><br><span class="line">	t2.`jname`, -- 职务名称</span><br><span class="line">	t2.`description`, -- 职务描述</span><br><span class="line">	t3.`dname`, -- 部门名称</span><br><span class="line">	t3.`loc` -- 部门位置</span><br><span class="line">FROM </span><br><span class="line">	emp t1, job t2,dept t3</span><br><span class="line">WHERE </span><br><span class="line">	t1.`job_id` = t2.`id` AND t1.`dept_id` = t3.`id`;</span><br><span class="line">   </span><br><span class="line">-- 3.查询员工姓名，工资，工资等级</span><br><span class="line">SELECT </span><br><span class="line">	t1.ename ,</span><br><span class="line">	t1.`salary`,</span><br><span class="line">	t2.*</span><br><span class="line">FROM emp t1, salarygrade t2</span><br><span class="line">WHERE t1.`salary` BETWEEN t2.`losalary` AND t2.`hisalary`;</span><br><span class="line">-- 4.查询员工姓名，工资，职务名称，职务描述，部门名称，部门位置，工资等级</span><br><span class="line">SELECT </span><br><span class="line">	t1.`ename`,</span><br><span class="line">	t1.`salary`,</span><br><span class="line">	t2.`jname`,</span><br><span class="line">	t2.`description`,</span><br><span class="line">	t3.`dname`,</span><br><span class="line">	t3.`loc`,</span><br><span class="line">	t4.`grade`</span><br><span class="line">FROM </span><br><span class="line">	emp t1,job t2,dept t3,salarygrade t4</span><br><span class="line">WHERE </span><br><span class="line">	t1.`job_id` = t2.`id` </span><br><span class="line">	AND t1.`dept_id` = t3.`id`</span><br><span class="line">	AND t1.`salary` BETWEEN t4.`losalary` AND t4.`hisalary`;</span><br><span class="line">-- 5.查询出部门编号、部门名称、部门位置、部门人数</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	分析：</span><br><span class="line">		1.部门编号、部门名称、部门位置 dept 表。 部门人数 emp表</span><br><span class="line">		2.使用分组查询。按照emp.dept_id完成分组，查询count(id)</span><br><span class="line">		3.使用子查询将第2步的查询结果和dept表进行关联查询</span><br><span class="line">		</span><br><span class="line">*/</span><br><span class="line">SELECT </span><br><span class="line">	t1.`id`,t1.`dname`,t1.`loc` , t2.total</span><br><span class="line">FROM </span><br><span class="line">	dept t1,</span><br><span class="line">	(SELECT</span><br><span class="line">		dept_id,COUNT(id) total</span><br><span class="line">	FROM </span><br><span class="line">		emp</span><br><span class="line">	GROUP BY dept_id) t2</span><br><span class="line">WHERE t1.`id` = t2.dept_id;</span><br><span class="line">-- 6.查询所有员工的姓名及其直接上级的姓名,没有领导的员工也需要查询</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	分析：</span><br><span class="line">		1.姓名 emp， 直接上级的姓名 emp</span><br><span class="line">			* emp表的id 和 mgr 是自关联</span><br><span class="line">		2.条件 emp.id = emp.mgr</span><br><span class="line">		3.查询左表的所有数据，和 交集数据</span><br><span class="line">			* 使用左外连接查询</span><br><span class="line">	</span><br><span class="line">*/</span><br><span class="line">/*</span><br><span class="line">select</span><br><span class="line">	t1.ename,</span><br><span class="line">	t1.mgr,</span><br><span class="line">	t2.`id`,</span><br><span class="line">	t2.ename</span><br><span class="line">from emp t1, emp t2</span><br><span class="line">where t1.mgr = t2.`id`;</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">	t1.ename,</span><br><span class="line">	t1.mgr,</span><br><span class="line">	t2.`id`,</span><br><span class="line">	t2.`ename`</span><br><span class="line">FROM emp t1</span><br><span class="line">LEFT JOIN emp t2</span><br><span class="line">ON t1.`mgr` = t2.`id`;</span><br></pre></td></tr></table></figure>

<h3 id="DCL：用户及其权限管理"><a href="#DCL：用户及其权限管理" class="headerlink" title="DCL：用户及其权限管理"></a>DCL：用户及其权限管理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">* SQL分类：</span><br><span class="line">	1. DDL：操作数据库和表</span><br><span class="line">	2. DML：增删改表中数据</span><br><span class="line">	3. DQL：查询表中数据</span><br><span class="line">	4. DCL：管理用户，授权</span><br><span class="line"></span><br><span class="line">* DBA：数据库管理员</span><br><span class="line"></span><br><span class="line">* DCL：管理用户，授权</span><br><span class="line">	1. 管理用户</span><br><span class="line">		1. 添加用户：</span><br><span class="line">			* 语法：CREATE USER &apos;用户名&apos;@&apos;主机名&apos; IDENTIFIED BY &apos;密码&apos;;</span><br><span class="line">		2. 删除用户：</span><br><span class="line">			* 语法：DROP USER &apos;用户名&apos;@&apos;主机名&apos;;</span><br><span class="line">		3. 修改用户密码：</span><br><span class="line">			</span><br><span class="line">			UPDATE USER SET PASSWORD = PASSWORD(&apos;新密码&apos;) WHERE USER = &apos;用户名&apos;;</span><br><span class="line">			UPDATE USER SET PASSWORD = PASSWORD(&apos;abc&apos;) WHERE USER = &apos;lisi&apos;;</span><br><span class="line">			</span><br><span class="line">			SET PASSWORD FOR &apos;用户名&apos;@&apos;主机名&apos; = PASSWORD(&apos;新密码&apos;);</span><br><span class="line">			SET PASSWORD FOR &apos;root&apos;@&apos;localhost&apos; = PASSWORD(&apos;123&apos;);</span><br><span class="line"></span><br><span class="line">			* mysql中忘记了root用户的密码？</span><br><span class="line">				1. cmd -- &gt; net stop mysql 停止mysql服务</span><br><span class="line">					* 需要管理员运行该cmd</span><br><span class="line"></span><br><span class="line">				2. 使用无验证方式启动mysql服务： mysqld --skip-grant-tables</span><br><span class="line">				3. 打开新的cmd窗口,直接输入mysql命令，敲回车。就可以登录成功</span><br><span class="line">				4. use mysql;</span><br><span class="line">				5. update user set password = password(&apos;你的新密码&apos;) where user = &apos;root&apos;;</span><br><span class="line">				6. 关闭两个窗口</span><br><span class="line">				7. 打开任务管理器，手动结束mysqld.exe 的进程</span><br><span class="line">				8. 启动mysql服务</span><br><span class="line">				9. 使用新密码登录。</span><br><span class="line">		4. 查询用户：</span><br><span class="line">			-- 1. 切换到mysql数据库</span><br><span class="line">			USE myql;</span><br><span class="line">			-- 2. 查询user表</span><br><span class="line">			SELECT * FROM USER;</span><br><span class="line">			</span><br><span class="line">			* 通配符： % 表示可以在任意主机使用用户登录数据库</span><br><span class="line"></span><br><span class="line">	2. 权限管理：</span><br><span class="line">		1. 查询权限：</span><br><span class="line">			-- 查询权限</span><br><span class="line">			SHOW GRANTS FOR &apos;用户名&apos;@&apos;主机名&apos;;</span><br><span class="line">			SHOW GRANTS FOR &apos;lisi&apos;@&apos;%&apos;;</span><br><span class="line"></span><br><span class="line">		2. 授予权限：</span><br><span class="line">			-- 授予权限</span><br><span class="line">			grant 权限列表 on 数据库名.表名 to &apos;用户名&apos;@&apos;主机名&apos;;</span><br><span class="line">			-- 给张三用户授予所有权限，在任意数据库任意表上</span><br><span class="line">			GRANT ALL ON *.* TO &apos;zhangsan&apos;@&apos;localhost&apos;;</span><br><span class="line">		3. 撤销权限：</span><br><span class="line">			-- 撤销权限：</span><br><span class="line">			revoke 权限列表 on 数据库名.表名 from &apos;用户名&apos;@&apos;主机名&apos;;</span><br><span class="line">			REVOKE UPDATE ON db3.`account` FROM &apos;lisi&apos;@&apos;%&apos;;</span><br></pre></td></tr></table></figure>

<h2 id="数据库的设计"><a href="#数据库的设计" class="headerlink" title="数据库的设计"></a>数据库的设计</h2><h3 id="多表关系"><a href="#多表关系" class="headerlink" title="多表关系"></a>多表关系</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1. 多表之间的关系</span><br><span class="line">	1. 分类：</span><br><span class="line">		1. 一对一(了解)：</span><br><span class="line">			* 如：人和身份证</span><br><span class="line">			* 分析：一个人只有一个身份证，一个身份证只能对应一个人</span><br><span class="line">		2. 一对多(多对一)：</span><br><span class="line">			* 如：部门和员工</span><br><span class="line">			* 分析：一个部门有多个员工，一个员工只能对应一个部门</span><br><span class="line">		3. 多对多：</span><br><span class="line">			* 如：学生和课程</span><br><span class="line">			* 分析：一个学生可以选择很多门课程，一个课程也可以被很多学生选择</span><br><span class="line">	2. 实现关系：</span><br><span class="line">		1. 一对多(多对一)：</span><br><span class="line">			* 如：部门和员工</span><br><span class="line">			* 实现方式：在多的一方建立外键，指向一的一方的主键。</span><br><span class="line">		2. 多对多：</span><br><span class="line">			* 如：学生和课程</span><br><span class="line">			* 实现方式：多对多关系实现需要借助第三张中间表。</span><br><span class="line">			  中间表至少包含两个字段，这两个字段作为第三张表的外键，分别指向两张表的主键</span><br><span class="line">		3. 一对一(了解)：</span><br><span class="line">			* 如：人和身份证</span><br><span class="line">			* 实现方式：一对一关系实现，可以在任意一方添加唯一外键指向另一方的主键。</span><br></pre></td></tr></table></figure>

<h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><p><img src="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225182029-694089.png" alt="image-20200225182028636"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">-- 创建旅游线路分类表 tab_category</span><br><span class="line">-- cid 旅游线路分类主键，自动增长</span><br><span class="line">-- cname 旅游线路分类名称非空，唯一，字符串 100</span><br><span class="line">CREATE TABLE tab_category (</span><br><span class="line">	cid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	cname VARCHAR(100) NOT NULL UNIQUE</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 创建旅游线路表 tab_route</span><br><span class="line">/*</span><br><span class="line">rid 旅游线路主键，自动增长</span><br><span class="line">rname 旅游线路名称非空，唯一，字符串 100</span><br><span class="line">price 价格</span><br><span class="line">rdate 上架时间，日期类型</span><br><span class="line">cid 外键，所属分类</span><br><span class="line">*/</span><br><span class="line">CREATE TABLE tab_route(</span><br><span class="line">	rid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	rname VARCHAR(100) NOT NULL UNIQUE,</span><br><span class="line">	price DOUBLE,</span><br><span class="line">	rdate DATE,</span><br><span class="line">	cid INT,</span><br><span class="line">	FOREIGN KEY (cid) REFERENCES tab_category(cid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">/*创建用户表 tab_user</span><br><span class="line">uid 用户主键，自增长</span><br><span class="line">username 用户名长度 100，唯一，非空</span><br><span class="line">password 密码长度 30，非空</span><br><span class="line">name 真实姓名长度 100</span><br><span class="line">birthday 生日</span><br><span class="line">sex 性别，定长字符串 1</span><br><span class="line">telephone 手机号，字符串 11</span><br><span class="line">email 邮箱，字符串长度 100</span><br><span class="line">*/</span><br><span class="line">CREATE TABLE tab_user (</span><br><span class="line">	uid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	username VARCHAR(100) UNIQUE NOT NULL,</span><br><span class="line">	PASSWORD VARCHAR(30) NOT NULL,</span><br><span class="line">	NAME VARCHAR(100),</span><br><span class="line">	birthday DATE,</span><br><span class="line">	sex CHAR(1) DEFAULT &apos;男&apos;,</span><br><span class="line">	telephone VARCHAR(11),</span><br><span class="line">	email VARCHAR(100)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">创建收藏表 tab_favorite</span><br><span class="line">rid 旅游线路 id，外键</span><br><span class="line">date 收藏时间</span><br><span class="line">uid 用户 id，外键</span><br><span class="line">rid 和 uid 不能重复，设置复合主键，同一个用户不能收藏同一个线路两次</span><br><span class="line">*/</span><br><span class="line">CREATE TABLE tab_favorite (</span><br><span class="line">	rid INT, -- 线路id</span><br><span class="line">	DATE DATETIME,</span><br><span class="line">	uid INT, -- 用户id</span><br><span class="line">	-- 创建复合主键</span><br><span class="line">	PRIMARY KEY(rid,uid), -- 联合主键</span><br><span class="line">	FOREIGN KEY (rid) REFERENCES tab_route(rid),</span><br><span class="line">	FOREIGN KEY(uid) REFERENCES tab_user(uid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="数据库设计的范式"><a href="#数据库设计的范式" class="headerlink" title="数据库设计的范式"></a>数据库设计的范式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">* 概念：设计数据库时，需要遵循的一些规范。要遵循后边的范式要求，必须先遵循前边的所有范式要求</span><br><span class="line"></span><br><span class="line">	设计关系数据库时，遵从不同的规范要求，设计出合理的关系型数据库，</span><br><span class="line">	这些不同的规范要求被称为不同的范式，各种范式呈递次规范，越高的范式数据库冗余越小。</span><br><span class="line">	目前关系数据库有六种范式：第一范式（1NF）、第二范式（2NF）、第三范式（3NF）、</span><br><span class="line">			巴斯-科德范式（BCNF）、第四范式(4NF）和第五范式（5NF，又称完美范式）。</span><br><span class="line"></span><br><span class="line">* 分类：</span><br><span class="line">	1. 第一范式（1NF）：每一列都是不可分割的原子数据项</span><br><span class="line">	2. 第二范式（2NF）：在1NF的基础上，非码属性必须完全依赖于码</span><br><span class="line">                       （在1NF基础上消除非主属性对主码的部分函数依赖）</span><br><span class="line">		* 几个概念：</span><br><span class="line">			1. 函数依赖：A--&gt;B,如果通过A属性(属性组)的值，可以确定唯一B属性的值。则称B依赖于A</span><br><span class="line">				例如：学号--&gt;姓名。  （学号，课程名称） --&gt; 分数</span><br><span class="line">			2. 完全函数依赖：A--&gt;B， 如果A是一个属性组，</span><br><span class="line">                          则B属性值得确定需要依赖于A属性组中所有的属性值。</span><br><span class="line">				例如：（学号，课程名称） --&gt; 分数</span><br><span class="line">			3. 部分函数依赖：A--&gt;B，若A是一个属性组，则B属性值确定只需依赖于A属性组中某些值</span><br><span class="line">				例如：（学号，课程名称） -- &gt; 姓名</span><br><span class="line">			4. 传递函数依赖：A--&gt;B, B -- &gt;C . </span><br><span class="line">              如果通过A属性(属性组)的值，可以确定唯一B属性的值，</span><br><span class="line">              在通过B属性（属性组）的值可以确定唯一C属性的值，则称 C 传递函数依赖于A</span><br><span class="line">				例如：学号--&gt;系名，系名--&gt;系主任</span><br><span class="line">			5. 码：如果在一张表中，一个属性或属性组，被其他所有属性所完全依赖，</span><br><span class="line">                              则称这个属性(属性组)为该表的码</span><br><span class="line">				例如：该表中码为：（学号，课程名称）</span><br><span class="line">				* 主属性：码属性组中的所有属性</span><br><span class="line">				* 非主属性：除过码属性组的属性</span><br><span class="line">				</span><br><span class="line">	3. 第三范式（3NF）:在2NF基础上,任何非主属性不依赖于其它非主属性，即在2NF基础上消除传递依赖</span><br></pre></td></tr></table></figure>

<h4 id="范例"><a href="#范例" class="headerlink" title="范例"></a>范例</h4><p><img src="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225182141-288535.png" alt></p>
<ul>
<li>系下面有两个子项，根据范式一将其拆分–  即所有可以建表的都满足范式一</li>
</ul>
<p><img src="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225182454-341727.png" alt></p>
<ul>
<li><p>范式二：消除非主属性对主码的部分函数依赖    </p>
<p>学号-&gt;姓名，系名，系主任(包含传递依赖)</p>
<p>学号，课程名称-&gt;成绩</p>
<p>姓名，系名，系主任对（学号，课程名称）存在部分依赖</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225183302-587709.png" alt="image-20200225183302339"></p>
<ul>
<li><p>选课表不存在传递依赖</p>
<p>学号 –&gt;  姓名 –&gt;  系名  –&gt;  系主任        存在传递依赖</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/guardwarm/imageBed/master/typora20200225183458-120425.png" alt="image-20200225183458064"></p>
<h2 id="数据库的备份和还原"><a href="#数据库的备份和还原" class="headerlink" title="数据库的备份和还原"></a>数据库的备份和还原</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. 命令行：</span><br><span class="line">	* 语法：</span><br><span class="line">		* 备份： mysqldump -u用户名 -p密码 数据库名称 &gt; 保存的路径</span><br><span class="line">		* 还原：</span><br><span class="line">			1. 登录数据库</span><br><span class="line">			2. 创建数据库</span><br><span class="line">			3. 使用数据库</span><br><span class="line">			4. 执行文件		source 文件路径</span><br><span class="line">2. 图形化工具：</span><br></pre></td></tr></table></figure>

<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">1. 事务的基本介绍</span><br><span class="line">	1. 概念：</span><br><span class="line">		*  如果一个包含多个步骤的业务操作，被事务管理，那么这些操作要么同时成功，要么同时失败。</span><br><span class="line">		</span><br><span class="line">	2. 操作：</span><br><span class="line">		1. 开启事务： start transaction;</span><br><span class="line">		2. 回滚：rollback;</span><br><span class="line">		3. 提交：commit;</span><br><span class="line">	3. MySQL数据库中事务默认自动提交</span><br><span class="line">		* 事务提交的两种方式：</span><br><span class="line">			* 自动提交：</span><br><span class="line">				* mysql就是自动提交的</span><br><span class="line">				* 一条DML(增删改)语句会自动提交一次事务。</span><br><span class="line">			* 手动提交：</span><br><span class="line">				* Oracle 数据库默认是手动提交事务</span><br><span class="line">				* 需要先开启事务，再提交</span><br><span class="line">		* 修改事务的默认提交方式：</span><br><span class="line">			* 查看事务的默认提交方式：SELECT @@autocommit; -- 1 代表自动提交  0 代表手动提交</span><br><span class="line">			* 修改默认提交方式： set @@autocommit = 0;</span><br><span class="line">2. 事务的四大特征：</span><br><span class="line">	1. 原子性：是不可分割的最小操作单位，要么同时成功，要么同时失败。</span><br><span class="line">	2. 持久性：当事务提交或回滚后，数据库会持久化的保存数据。</span><br><span class="line">	3. 隔离性：多个事务之间。相互独立。</span><br><span class="line">	4. 一致性：事务操作前后，数据总量不变</span><br><span class="line">3. 事务的隔离级别（了解）</span><br><span class="line">	* 概念：多个事务之间隔离的，相互独立的。但是如果多个事务操作同一批数据，则会引发一些问题，设置不同的隔离级别就可以解决这些问题。</span><br><span class="line">	* 存在问题：</span><br><span class="line">		1. 脏读：一个事务，读取到另一个事务中没有提交的数据</span><br><span class="line">		2. 不可重复读(虚读)：在同一个事务中，两次读取到的数据不一样。</span><br><span class="line">		3. 幻读：一个事务操作(DML)数据表中所有记录，另一个事务添加了一条数据，则第一个事务查询不到自己的修改。</span><br><span class="line">	* 隔离级别：</span><br><span class="line">		1. read uncommitted：读未提交</span><br><span class="line">			* 产生的问题：脏读、不可重复读、幻读</span><br><span class="line">		2. read committed：读已提交 （Oracle）</span><br><span class="line">			* 产生的问题：不可重复读、幻读</span><br><span class="line">		3. repeatable read：可重复读 （MySQL默认）</span><br><span class="line">			* 产生的问题：幻读</span><br><span class="line">		4. serializable：串行化</span><br><span class="line">			* 可以解决所有的问题</span><br><span class="line"></span><br><span class="line">		* 注意：隔离级别从小到大安全性越来越高，但是效率越来越低</span><br><span class="line">		* 数据库查询隔离级别：</span><br><span class="line">			* select @@tx_isolation;</span><br><span class="line">		* 数据库设置隔离级别：</span><br><span class="line">			* set global transaction isolation level  级别字符串;</span><br><span class="line"></span><br><span class="line">	* 演示：</span><br><span class="line">		set global transaction isolation level read uncommitted;</span><br><span class="line">		start transaction;</span><br><span class="line">		-- 转账操作</span><br><span class="line">		update account set balance = balance - 500 where id = 1;</span><br><span class="line">		update account set balance = balance + 500 where id = 2;</span><br></pre></td></tr></table></figure>

<h2 id="异常解决"><a href="#异常解决" class="headerlink" title="异常解决"></a>异常解决</h2><p>【MySQL】SELECT list is not in GROUP BY clause… </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT a.*  FROM tbl_inspection_equipment_record a</span><br><span class="line">RIGHT  JOIN   (</span><br><span class="line">    SELECT * FROM tbl_inspection_equipment_record </span><br><span class="line">        WHERE state =  1 </span><br><span class="line">        AND build_id = ?</span><br><span class="line">    ORDER BY end_time DESC</span><br><span class="line">)  AS temp</span><br><span class="line">ON a.id  = temp.id</span><br><span class="line">GROUP BY room_id</span><br><span class="line">ORDER BY end_time DESC</span><br></pre></td></tr></table></figure>

<p>问题原因</p>
<p>MySQL 5.7.5及以上功能依赖检测功能。如果启用了 ONLY_FULL_GROUP_BY SQL 模式（默认情况下），MySQL 将拒绝选择列表，HAVING 条件或 ORDER BY 列表的查询引用在 GROUP BY 子句中既未命名的非集合列，也不在功能上依赖于它们。（5.7.5之前，MySQL 没有检测到功能依赖关系，默认情况下不启用 ONLY_FULL_GROUP_BY。有关5.7.5之前的行为的说明，请参见“MySQL 5.6参考手册”。）</p>
<p>解决方案<br>方法一(该方式每次mysql服务重新启动恢复原来的模式)</p>
<p>S1：select @@global.sql_mode;</p>
<p>S2：执行以下sql语句，去除步骤1中 <code>ONLY_FULL_GROUP_BY</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">set @@global.sql_mode =</span><br><span class="line">&apos;STRICT_TRANS_TABLES,</span><br><span class="line">NO_ZERO_IN_DATE,</span><br><span class="line">NO_ZERO_DATE,</span><br><span class="line">ERROR_FOR_DIVISION_BY_ZERO,</span><br><span class="line">NO_AUTO_CREATE_USER,</span><br><span class="line">NO_ENGINE_SUBSTITUTION&apos;;</span><br></pre></td></tr></table></figure>

<p>方法二：修改配置文件</p>
<ul>
<li>远程服务器找到 <code>my.cnf</code> 文件</li>
<li>在文件底部加入</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,</span><br><span class="line">ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION</span><br></pre></td></tr></table></figure>

<ul>
<li>重启mysql</li>
</ul>
<h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><h2 id="JDBC简单实现"><a href="#JDBC简单实现" class="headerlink" title="JDBC简单实现"></a>JDBC简单实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 概念：Java DataBase Connectivity  Java 数据库连接， Java语言操作数据库</span><br><span class="line">	* JDBC本质：其实是官方（sun公司）定义的一套操作所有关系型数据库的规则，即接口。各个数据库厂商去实现这套接口，提供数据库驱动jar包。我们可以使用这套接口（JDBC）编程，真正执行的代码是驱动jar包中的实现类。</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>. 快速入门：</span><br><span class="line">	* 步骤：</span><br><span class="line">		<span class="number">1</span>. 导入驱动jar包 mysql-connector-java-<span class="number">5.1</span>.37-bin.jar</span><br><span class="line">			<span class="number">1</span>.复制mysql-connector-java-<span class="number">5.1</span>.37-bin.jar到项目的libs目录下</span><br><span class="line">			<span class="number">2</span>.右键--&gt;Add As Library</span><br><span class="line">		<span class="number">2</span>. 注册驱动</span><br><span class="line">		<span class="number">3</span>. 获取数据库连接对象 Connection</span><br><span class="line">		<span class="number">4</span>. 定义sql</span><br><span class="line">		<span class="number">5</span>. 获取执行sql语句的对象 Statement</span><br><span class="line">		<span class="number">6</span>. 执行sql，接受返回结果</span><br><span class="line">		<span class="number">7</span>. 处理结果</span><br><span class="line">		<span class="number">8</span>. 释放资源</span><br><span class="line"></span><br><span class="line">	* 代码实现：</span><br><span class="line">	  	<span class="comment">//1. 导入驱动jar包</span></span><br><span class="line">        <span class="comment">//2.注册驱动</span></span><br><span class="line">        Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">        <span class="comment">//3.获取数据库连接对象</span></span><br><span class="line">        Connection conn = DriverManager.getConnection(<span class="string">"jdbc:mysql://localhost:3306/db3"</span>, <span class="string">"root"</span>, <span class="string">"root"</span>);</span><br><span class="line">        <span class="comment">//4.定义sql语句</span></span><br><span class="line">        String sql = <span class="string">"update account set balance = 500 where id = 1"</span>;</span><br><span class="line">        <span class="comment">//5.获取执行sql的对象 Statement</span></span><br><span class="line">        Statement stmt = conn.createStatement();</span><br><span class="line">        <span class="comment">//6.执行sql</span></span><br><span class="line">        <span class="keyword">int</span> count = stmt.executeUpdate(sql);</span><br><span class="line">        <span class="comment">//7.处理结果</span></span><br><span class="line">        System.out.println(count);</span><br><span class="line">        <span class="comment">//8.释放资源</span></span><br><span class="line">        stmt.close();</span><br><span class="line">        conn.close();</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>. 详解各个对象：</span><br><span class="line">	<span class="number">1</span>. DriverManager：驱动管理对象</span><br><span class="line">		* 功能：</span><br><span class="line">			<span class="number">1</span>. 注册驱动：告诉程序该使用哪一个数据库驱动jar</span><br><span class="line">				<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">registerDriver</span><span class="params">(Driver driver)</span> :注册与给定的驱动程序 DriverManager 。 </span></span><br><span class="line"><span class="function">				写代码使用：  Class.<span class="title">forName</span><span class="params">(<span class="string">"com.mysql.jdbc.Driver"</span>)</span></span>;</span><br><span class="line">				通过查看源码发现：在com.mysql.jdbc.Driver类中存在静态代码块</span><br><span class="line">				 <span class="keyword">static</span> &#123;</span><br><span class="line">				        <span class="keyword">try</span> &#123;</span><br><span class="line">				            java.sql.DriverManager.registerDriver(<span class="keyword">new</span> Driver());</span><br><span class="line">				        &#125; <span class="keyword">catch</span> (SQLException E) &#123;</span><br><span class="line">				            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Can't register driver!"</span>);</span><br><span class="line">				        &#125;</span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">				注意：mysql5之后的驱动jar包可以省略注册驱动的步骤。</span><br><span class="line">			<span class="number">2</span>. 获取数据库连接：</span><br><span class="line">				* 方法：<span class="function"><span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">(String url, String user, String password)</span> </span></span><br><span class="line"><span class="function">				* 参数：</span></span><br><span class="line"><span class="function">					* url：指定连接的路径</span></span><br><span class="line"><span class="function">						* 语法：jdbc:mysql:<span class="comment">//ip地址(域名):端口号/数据库名称</span></span></span><br><span class="line"><span class="function">						* 例子：jdbc:mysql:<span class="comment">//localhost:3306/db3</span></span></span><br><span class="line"><span class="function">						* 细节：如果连接的是本机mysql服务器，并且mysql服务默认端口是3306，则url可以简写为：jdbc:mysql:<span class="comment">///数据库名称</span></span></span><br><span class="line"><span class="function">					* user：用户名</span></span><br><span class="line"><span class="function">					* password：密码 </span></span><br><span class="line"><span class="function">	2. Connection：数据库连接对象</span></span><br><span class="line"><span class="function">		1. 功能：</span></span><br><span class="line"><span class="function">			1. 获取执行sql 的对象</span></span><br><span class="line"><span class="function">				* Statement <span class="title">createStatement</span><span class="params">()</span></span></span><br><span class="line"><span class="function">				* PreparedStatement <span class="title">prepareStatement</span><span class="params">(String sql)</span>  </span></span><br><span class="line"><span class="function">			2. 管理事务：</span></span><br><span class="line"><span class="function">				* 开启事务：<span class="title">setAutoCommit</span><span class="params">(<span class="keyword">boolean</span> autoCommit)</span> ：调用该方法设置参数为<span class="keyword">false</span>，即开启事务</span></span><br><span class="line"><span class="function">				* 提交事务：<span class="title">commit</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">				* 回滚事务：<span class="title">rollback</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">	3. Statement：执行sql的对象</span></span><br><span class="line"><span class="function">		1. 执行sql</span></span><br><span class="line"><span class="function">			1. <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(String sql)</span> ：可以执行任意的sql 了解 </span></span><br><span class="line"><span class="function">			2. <span class="keyword">int</span> <span class="title">executeUpdate</span><span class="params">(String sql)</span> ：执行DML（insert、update、delete）语句、<span class="title">DDL</span><span class="params">(create，alter、drop)</span>语句</span></span><br><span class="line"><span class="function">				* 返回值：影响的行数，可以通过这个影响的行数判断DML语句是否执行成功 返回值&gt;0的则执行成功，反之，则失败。</span></span><br><span class="line"><span class="function">			3. ResultSet <span class="title">executeQuery</span><span class="params">(String sql)</span>  ：执行DQL（select)语句</span></span><br><span class="line"><span class="function">	4. ResultSet：结果集对象,封装查询结果</span></span><br><span class="line"><span class="function">		* <span class="keyword">boolean</span> <span class="title">next</span><span class="params">()</span>: 游标向下移动一行，判断当前行是否是最后一行末尾<span class="params">(是否有数据)</span>，如果是，则返回<span class="keyword">false</span>，如果不是则返回<span class="keyword">true</span></span></span><br><span class="line"><span class="function">		* <span class="title">getXxx</span><span class="params">(参数)</span>:获取数据</span></span><br><span class="line"><span class="function">			* Xxx：代表数据类型   如： <span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span> ,	String <span class="title">getString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">			* 参数：</span></span><br><span class="line"><span class="function">				1. <span class="keyword">int</span>：代表列的编号,从1开始   如： <span class="title">getString</span><span class="params">(<span class="number">1</span>)</span></span></span><br><span class="line"><span class="function">				2. String：代表列名称。 如： <span class="title">getDouble</span><span class="params">(<span class="string">"balance"</span>)</span></span></span><br><span class="line"><span class="function">		</span></span><br><span class="line"><span class="function">		* 注意：</span></span><br><span class="line"><span class="function">			* 使用步骤：</span></span><br><span class="line"><span class="function">				1. 游标向下移动一行</span></span><br><span class="line"><span class="function">				2. 判断是否有数据</span></span><br><span class="line"><span class="function">				3. 获取数据</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">			   <span class="comment">//循环判断游标是否是最后一行末尾。</span></span></span><br><span class="line"><span class="function">	            <span class="title">while</span><span class="params">(rs.next()</span>)</span>&#123;</span><br><span class="line">	                <span class="comment">//获取数据</span></span><br><span class="line">	                <span class="comment">//6.2 获取数据</span></span><br><span class="line">	                <span class="keyword">int</span> id = rs.getInt(<span class="number">1</span>);</span><br><span class="line">	                String name = rs.getString(<span class="string">"name"</span>);</span><br><span class="line">	                <span class="keyword">double</span> balance = rs.getDouble(<span class="number">3</span>);</span><br><span class="line">	                System.out.println(id + <span class="string">"---"</span> + name + <span class="string">"---"</span> + balance);</span><br><span class="line">	            &#125;			</span><br><span class="line">	<span class="number">5</span>. PreparedStatement：执行sql的对象</span><br><span class="line">		<span class="number">1</span>. SQL注入问题：在拼接sql时，有一些sql的特殊关键字参与字符串的拼接。会造成安全性问题</span><br><span class="line">			<span class="number">1</span>. 输入用户随便，输入密码：a<span class="string">' or '</span>a<span class="string">' = '</span>a</span><br><span class="line">			<span class="number">2</span>. sql：select * from user where username = <span class="string">'fhdsjkf'</span> and password = <span class="string">'a'</span> or <span class="string">'a'</span> = <span class="string">'a'</span> </span><br><span class="line"></span><br><span class="line">		<span class="number">2</span>. 解决sql注入问题：使用PreparedStatement对象来解决</span><br><span class="line">		<span class="number">3</span>. 预编译的SQL：参数使用?作为占位符</span><br><span class="line">		<span class="number">4</span>. 步骤：</span><br><span class="line">			<span class="number">1</span>. 导入驱动jar包 mysql-connector-java-<span class="number">5.1</span>.37-bin.jar</span><br><span class="line">			<span class="number">2</span>. 注册驱动</span><br><span class="line">			<span class="number">3</span>. 获取数据库连接对象 Connection</span><br><span class="line">			<span class="number">4</span>. 定义sql</span><br><span class="line">				* 注意：sql的参数使用？作为占位符。 如：select * from user where username = ? and password = ?;</span><br><span class="line">			<span class="number">5</span>. 获取执行sql语句的对象 PreparedStatement  Connection.prepareStatement(String sql) </span><br><span class="line">			<span class="number">6</span>. 给？赋值：</span><br><span class="line">				* 方法： setXxx(参数<span class="number">1</span>,参数<span class="number">2</span>)</span><br><span class="line">					* 参数<span class="number">1</span>：？的位置编号 从<span class="number">1</span> 开始</span><br><span class="line">					* 参数<span class="number">2</span>：？的值</span><br><span class="line">			<span class="number">7</span>. 执行sql，接受返回结果，不需要传递sql语句</span><br><span class="line">			<span class="number">8</span>. 处理结果</span><br><span class="line">			<span class="number">9</span>. 释放资源</span><br><span class="line"></span><br><span class="line">		<span class="number">5</span>. 注意：后期都会使用PreparedStatement来完成增删改查的所有操作</span><br><span class="line">			<span class="number">1</span>. 可以防止SQL注入</span><br><span class="line">			<span class="number">2</span>. 效率更高</span><br></pre></td></tr></table></figure>

<h2 id="抽取JDBC工具类-：-JDBCUtils"><a href="#抽取JDBC工具类-：-JDBCUtils" class="headerlink" title="抽取JDBC工具类 ： JDBCUtils"></a>抽取JDBC工具类 ： JDBCUtils</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	1. 注册驱动也抽取</span></span><br><span class="line"><span class="comment">	2. 抽取一个方法获取连接对象</span></span><br><span class="line"><span class="comment">		* 需求：不想传递参数（麻烦），还得保证工具类的通用性。</span></span><br><span class="line"><span class="comment">		* 解决：配置文件</span></span><br><span class="line"><span class="comment">			jdbc.properties</span></span><br><span class="line"><span class="comment">				url=</span></span><br><span class="line"><span class="comment">				user=</span></span><br><span class="line"><span class="comment">				password=</span></span><br><span class="line"><span class="comment">	3. 抽取一个方法释放资源</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCUtils</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String url;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String user;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String password;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String driver;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件的读取，只需要读取一次即可拿到这些值。使用静态代码块</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="comment">//读取资源文件，获取值。</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1. 创建Properties集合类。</span></span><br><span class="line">            Properties pro = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//获取src路径下的文件的方式---&gt;ClassLoader 类加载器</span></span><br><span class="line">            ClassLoader classLoader = JDBCUtils.class.getClassLoader();</span><br><span class="line">            URL res  = classLoader.getResource(<span class="string">"jdbc.properties"</span>);</span><br><span class="line">            String path = res.getPath();</span><br><span class="line">            System.out.println(path);<span class="comment">///D:/IdeaProjects/itcast/out/production/day04_jdbc/jdbc.properties</span></span><br><span class="line">            <span class="comment">//2. 加载文件</span></span><br><span class="line">           <span class="comment">// pro.load(new FileReader("D:\\IdeaProjects\\itcast\\day04_jdbc\\src\\jdbc.properties"));</span></span><br><span class="line">            pro.load(<span class="keyword">new</span> FileReader(path));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//3. 获取数据，赋值</span></span><br><span class="line">            url = pro.getProperty(<span class="string">"url"</span>);</span><br><span class="line">            user = pro.getProperty(<span class="string">"user"</span>);</span><br><span class="line">            password = pro.getProperty(<span class="string">"password"</span>);</span><br><span class="line">            driver = pro.getProperty(<span class="string">"driver"</span>);</span><br><span class="line">            <span class="comment">//4. 注册驱动</span></span><br><span class="line">            Class.forName(driver);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取连接</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 连接对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> DriverManager.getConnection(url, user, password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 释放资源</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> stmt</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> conn</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(Statement stmt,Connection conn)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( stmt != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>( conn != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<pre><code>    /**
     * 释放资源
     * @param stmt
     * @param conn
     */
    public static void close(ResultSet rs,Statement stmt, Connection conn){
        if( rs != null){
            try {
                rs.close();
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }

        if( stmt != null){
            try {
                stmt.close();
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }

        if( conn != null){
            try {
                conn.close();
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }

}

* 练习：
    * 需求：
        1. 通过键盘录入用户名和密码
        2. 判断用户是否登录成功
            * select * from user where username = &quot;&quot; and password = &quot;&quot;;
            * 如果这个sql有查询结果，则成功，反之，则失败

    * 步骤：
        1. 创建数据库表 user
            CREATE TABLE USER(
                id INT PRIMARY KEY AUTO_INCREMENT,
                username VARCHAR(32),
                PASSWORD VARCHAR(32)

            );

            INSERT INTO USER VALUES(NULL,&apos;zhangsan&apos;,&apos;123&apos;);
            INSERT INTO USER VALUES(NULL,&apos;lisi&apos;,&apos;234&apos;);

        2. 代码实现：
            public class JDBCDemo9 {

                public static void main(String[] args) {
                    //1.键盘录入，接受用户名和密码
                    Scanner sc = new Scanner(System.in);
                    System.out.println(&quot;请输入用户名：&quot;);
                    String username = sc.nextLine();
                    System.out.println(&quot;请输入密码：&quot;);
                    String password = sc.nextLine();
                    //2.调用方法
                    boolean flag = new JDBCDemo9().login(username, password);
                    //3.判断结果，输出不同语句
                    if(flag){
                        //登录成功
                        System.out.println(&quot;登录成功！&quot;);
                    }else{
                        System.out.println(&quot;用户名或密码错误！&quot;);
                    }</code></pre><p>​                </p>
<pre><code>}</code></pre><p>​<br>​                </p>
<pre><code>/**
 * 登录方法
 */
public boolean login(String username ,String password){
    if(username == null || password == null){
        return false;
    }
    //连接数据库判断是否登录成功
    Connection conn = null;
    Statement stmt =  null;
    ResultSet rs = null;
    //1.获取连接
    try {
        conn =  JDBCUtils.getConnection();
        //2.定义sql
        String sql = &quot;select * from user where username = &apos;&quot;+username+&quot;&apos; and password = &apos;&quot;+password+&quot;&apos; &quot;;
        //3.获取执行sql的对象
        stmt = conn.createStatement();
        //4.执行查询
        rs = stmt.executeQuery(sql);
        //5.判断
       /* if(rs.next()){//如果有下一行，则返回true
            return true;
        }else{
            return false;
        }*/
       return rs.next();//如果有下一行，则返回true

    } catch (SQLException e) {
        e.printStackTrace();
    }finally {
        JDBCUtils.close(rs,stmt,conn);
    }</code></pre><p>​                </p>
<pre><code>        return false;
    }
}</code></pre><h2 id="JDBC控制事务："><a href="#JDBC控制事务：" class="headerlink" title="JDBC控制事务："></a>JDBC控制事务：</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1. 事务：一个包含多个步骤的业务操作。如果这个业务操作被事务管理，则这多个步骤要么同时成功，要么同时失败。</span></span><br><span class="line"><span class="comment">2. 操作：</span></span><br><span class="line"><span class="comment">	1. 开启事务</span></span><br><span class="line"><span class="comment">	2. 提交事务</span></span><br><span class="line"><span class="comment">	3. 回滚事务</span></span><br><span class="line"><span class="comment">3. 使用Connection对象来管理事务</span></span><br><span class="line"><span class="comment">	* 开启事务：setAutoCommit(boolean autoCommit) ：调用该方法设置参数为false，即开启事务</span></span><br><span class="line"><span class="comment">		* 在执行sql之前开启事务</span></span><br><span class="line"><span class="comment">	* 提交事务：commit() </span></span><br><span class="line"><span class="comment">		* 当所有sql都执行完提交事务</span></span><br><span class="line"><span class="comment">	* 回滚事务：rollback() </span></span><br><span class="line"><span class="comment">		* 在catch中回滚事务</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCDemo10</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">	        Connection conn = <span class="keyword">null</span>;</span><br><span class="line">	        PreparedStatement pstmt1 = <span class="keyword">null</span>;</span><br><span class="line">	        PreparedStatement pstmt2 = <span class="keyword">null</span>;</span><br><span class="line">	</span><br><span class="line">	        <span class="keyword">try</span> &#123;</span><br><span class="line">	            <span class="comment">//1.获取连接</span></span><br><span class="line">	            conn = JDBCUtils.getConnection();</span><br><span class="line">	            <span class="comment">//开启事务</span></span><br><span class="line">	            conn.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">	</span><br><span class="line">	            <span class="comment">//2.定义sql</span></span><br><span class="line">	            <span class="comment">//2.1 张三 - 500</span></span><br><span class="line">	            String sql1 = <span class="string">"update account set balance = balance - ? where id = ?"</span>;</span><br><span class="line">	            <span class="comment">//2.2 李四 + 500</span></span><br><span class="line">	            String sql2 = <span class="string">"update account set balance = balance + ? where id = ?"</span>;</span><br><span class="line">	            <span class="comment">//3.获取执行sql对象</span></span><br><span class="line">	            pstmt1 = conn.prepareStatement(sql1);</span><br><span class="line">	            pstmt2 = conn.prepareStatement(sql2);</span><br><span class="line">	            <span class="comment">//4. 设置参数</span></span><br><span class="line">	            pstmt1.setDouble(<span class="number">1</span>,<span class="number">500</span>);</span><br><span class="line">	            pstmt1.setInt(<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">	</span><br><span class="line">	            pstmt2.setDouble(<span class="number">1</span>,<span class="number">500</span>);</span><br><span class="line">	            pstmt2.setInt(<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">	            <span class="comment">//5.执行sql</span></span><br><span class="line">	            pstmt1.executeUpdate();</span><br><span class="line">	            <span class="comment">// 手动制造异常</span></span><br><span class="line">	            <span class="keyword">int</span> i = <span class="number">3</span>/<span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	            pstmt2.executeUpdate();</span><br><span class="line">	            <span class="comment">//提交事务</span></span><br><span class="line">	            conn.commit();</span><br><span class="line">	        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">	            <span class="comment">//事务回滚</span></span><br><span class="line">	            <span class="keyword">try</span> &#123;</span><br><span class="line">	                <span class="keyword">if</span>(conn != <span class="keyword">null</span>) &#123;</span><br><span class="line">	                    conn.rollback();</span><br><span class="line">	                &#125;</span><br><span class="line">	            &#125; <span class="keyword">catch</span> (SQLException e1) &#123;</span><br><span class="line">	                e1.printStackTrace();</span><br><span class="line">	            &#125;</span><br><span class="line">	            e.printStackTrace();</span><br><span class="line">	        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">	            JDBCUtils.close(pstmt1,conn);</span><br><span class="line">	            JDBCUtils.close(pstmt2,<span class="keyword">null</span>);</span><br><span class="line">	        &#125;</span><br><span class="line">	    &#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="数据库连接池"><a href="#数据库连接池" class="headerlink" title="数据库连接池"></a>数据库连接池</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1. 概念：其实就是一个容器(集合)，存放数据库连接的容器。</span></span><br><span class="line"><span class="comment">	    当系统初始化好后，容器被创建，容器中会申请一些连接对象，当用户来访问数据库时，</span></span><br><span class="line"><span class="comment">	    从容器中获取连接对象，用户访问完之后，会将连接对象归还给容器。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2. 好处：</span></span><br><span class="line"><span class="comment">	1. 节约资源</span></span><br><span class="line"><span class="comment">	2. 用户访问高效</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">3. 实现：</span></span><br><span class="line"><span class="comment">	1. 标准接口：DataSource   javax.sql包下的</span></span><br><span class="line"><span class="comment">		1. 方法：</span></span><br><span class="line"><span class="comment">			* 获取连接：getConnection()</span></span><br><span class="line"><span class="comment">			* 归还连接：Connection.close()。如果连接对象Connection是从连接池中获取的，</span></span><br><span class="line"><span class="comment">			  那么调用Connection.close()方法，则不会再关闭连接了。而是归还连接</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	2. 一般我们不去实现它，有数据库厂商来实现</span></span><br><span class="line"><span class="comment">		1. C3P0：数据库连接池技术</span></span><br><span class="line"><span class="comment">		2. Druid：数据库连接池实现技术，由阿里巴巴提供的</span></span><br><span class="line"><span class="comment">4. C3P0：数据库连接池技术</span></span><br><span class="line"><span class="comment">	* 步骤：</span></span><br><span class="line"><span class="comment">		1. 导入jar包 (两个) c3p0-0.9.5.2.jar mchange-commons-java-0.2.12.jar ，</span></span><br><span class="line"><span class="comment">			* 不要忘记导入数据库驱动jar包</span></span><br><span class="line"><span class="comment">		2. 定义配置文件：</span></span><br><span class="line"><span class="comment">			* 名称： c3p0.properties 或者 c3p0-config.xml</span></span><br><span class="line"><span class="comment">			* 路径：直接将文件放在src目录下即可。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		3. 创建核心对象 数据库连接池对象 ComboPooledDataSource</span></span><br><span class="line"><span class="comment">		4. 获取连接： getConnection</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">		 <span class="comment">//1.创建数据库连接池对象</span></span><br><span class="line">        DataSource ds  = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        <span class="comment">//2. 获取连接对象</span></span><br><span class="line">        Connection conn = ds.getConnection();</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5. Druid：数据库连接池实现技术，由阿里巴巴提供的</span></span><br><span class="line"><span class="comment">	1. 步骤：</span></span><br><span class="line"><span class="comment">		1. 导入jar包 druid-1.0.9.jar</span></span><br><span class="line"><span class="comment">		2. 定义配置文件：</span></span><br><span class="line"><span class="comment">			* 是properties形式的</span></span><br><span class="line"><span class="comment">			* 可以叫任意名称，可以放在任意目录下</span></span><br><span class="line"><span class="comment">		3. 加载配置文件。Properties</span></span><br><span class="line"><span class="comment">		4. 获取数据库连接池对象：通过工厂来来获取  DruidDataSourceFactory</span></span><br><span class="line"><span class="comment">		5. 获取连接：getConnection</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">		 <span class="comment">//3.加载配置文件</span></span><br><span class="line">        Properties pro = <span class="keyword">new</span> Properties();</span><br><span class="line">        InputStream is = DruidDemo.class.getClassLoader().getResourceAsStream(<span class="string">"druid.properties"</span>);</span><br><span class="line">        pro.load(is);</span><br><span class="line">        <span class="comment">//4.获取连接池对象</span></span><br><span class="line">        DataSource ds = DruidDataSourceFactory.createDataSource(pro);</span><br><span class="line">        <span class="comment">//5.获取连接</span></span><br><span class="line">        Connection conn = ds.getConnection();</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	2. 定义工具类</span></span><br><span class="line"><span class="comment">		1. 定义一个类 JDBCUtils</span></span><br><span class="line"><span class="comment">		2. 提供静态代码块加载配置文件，初始化连接池对象</span></span><br><span class="line"><span class="comment">		3. 提供方法</span></span><br><span class="line"><span class="comment">			1. 获取连接方法：通过数据库连接池获取连接</span></span><br><span class="line"><span class="comment">			2. 释放资源</span></span><br><span class="line"><span class="comment">			3. 获取连接池的方法</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">		<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		    <span class="comment">//1.定义成员变量 DataSource</span></span><br><span class="line">		    <span class="keyword">private</span> <span class="keyword">static</span> DataSource ds ;</span><br><span class="line">		</span><br><span class="line">		    <span class="keyword">static</span>&#123;</span><br><span class="line">		        <span class="keyword">try</span> &#123;</span><br><span class="line">		            <span class="comment">//1.加载配置文件</span></span><br><span class="line">		            Properties pro = <span class="keyword">new</span> Properties();</span><br><span class="line">		            pro.load(JDBCUtils.class.getClassLoader().getResourceAsStream(<span class="string">"druid.properties"</span>));</span><br><span class="line">		            <span class="comment">//2.获取DataSource</span></span><br><span class="line">		            ds = DruidDataSourceFactory.createDataSource(pro);</span><br><span class="line">		        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">		            e.printStackTrace();</span><br><span class="line">		        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">		            e.printStackTrace();</span><br><span class="line">		        &#125;</span><br><span class="line">		    &#125;</span><br><span class="line">		</span><br><span class="line">		    <span class="comment">/**</span></span><br><span class="line"><span class="comment">		     * 获取连接</span></span><br><span class="line"><span class="comment">		     */</span></span><br><span class="line">		    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">		        <span class="keyword">return</span> ds.getConnection();</span><br><span class="line">		    &#125;</span><br><span class="line">		</span><br><span class="line">		    <span class="comment">/**</span></span><br><span class="line"><span class="comment">		     * 释放资源</span></span><br><span class="line"><span class="comment">		     */</span></span><br><span class="line">		    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(Statement stmt,Connection conn)</span></span>&#123;</span><br><span class="line">		       <span class="comment">/* if(stmt != null)&#123;</span></span><br><span class="line"><span class="comment">		            try &#123;</span></span><br><span class="line"><span class="comment">		                stmt.close();</span></span><br><span class="line"><span class="comment">		            &#125; catch (SQLException e) &#123;</span></span><br><span class="line"><span class="comment">		                e.printStackTrace();</span></span><br><span class="line"><span class="comment">		            &#125;</span></span><br><span class="line"><span class="comment">		        &#125;</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		        if(conn != null)&#123;</span></span><br><span class="line"><span class="comment">		            try &#123;</span></span><br><span class="line"><span class="comment">		                conn.close();//归还连接</span></span><br><span class="line"><span class="comment">		            &#125; catch (SQLException e) &#123;</span></span><br><span class="line"><span class="comment">		                e.printStackTrace();</span></span><br><span class="line"><span class="comment">		            &#125;</span></span><br><span class="line"><span class="comment">		        &#125;*/</span></span><br><span class="line">		</span><br><span class="line">		       close(<span class="keyword">null</span>,stmt,conn);</span><br><span class="line">		    &#125;</span><br><span class="line">		    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(ResultSet rs , Statement stmt, Connection conn)</span></span>&#123;</span><br><span class="line">		        <span class="keyword">if</span>(rs != <span class="keyword">null</span>)&#123;</span><br><span class="line">		            <span class="keyword">try</span> &#123;</span><br><span class="line">		                rs.close();</span><br><span class="line">		            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">		                e.printStackTrace();</span><br><span class="line">		            &#125;</span><br><span class="line">		        &#125;</span><br><span class="line">		        <span class="keyword">if</span>(stmt != <span class="keyword">null</span>)&#123;</span><br><span class="line">		            <span class="keyword">try</span> &#123;</span><br><span class="line">		                stmt.close();</span><br><span class="line">		            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">		                e.printStackTrace();</span><br><span class="line">		            &#125;</span><br><span class="line">		        &#125;</span><br><span class="line">		</span><br><span class="line">		        <span class="keyword">if</span>(conn != <span class="keyword">null</span>)&#123;</span><br><span class="line">		            <span class="keyword">try</span> &#123;</span><br><span class="line">		                conn.close();<span class="comment">//归还连接</span></span><br><span class="line">		            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">		                e.printStackTrace();</span><br><span class="line">		            &#125;</span><br><span class="line">		        &#125;</span><br><span class="line">		    &#125;</span><br><span class="line">		</span><br><span class="line">		    <span class="comment">/**</span></span><br><span class="line"><span class="comment">		     * 获取连接池方法</span></span><br><span class="line"><span class="comment">		     */</span></span><br><span class="line">		</span><br><span class="line">		    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSource <span class="title">getDataSource</span><span class="params">()</span></span>&#123;</span><br><span class="line">		        <span class="keyword">return</span>  ds;</span><br><span class="line">		    &#125;</span><br><span class="line">		</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Spring-JDBC"><a href="#Spring-JDBC" class="headerlink" title="Spring JDBC"></a>Spring JDBC</h2><pre><code>Spring框架对JDBC的简单封装。提供了一个JDBCTemplate对象简化JDBC的开发
步骤：
   1. 导入jar包
   2. 创建JdbcTemplate对象。依赖于数据源DataSource
       * JdbcTemplate template = new JdbcTemplate(ds);

   3. 调用JdbcTemplate的方法来完成CRUD的操作
       * update():执行DML语句。增、删、改语句
       * queryForMap():查询结果将结果集封装为map集合，将列名作为key，将值作为value 将这条记录封装为一个map集合
           * 注意：这个方法查询的结果集长度只能是1
       * queryForList():查询结果将结果集封装为list集合
           * 注意：将每一条记录封装为一个Map集合，再将Map集合装载到List集合中
       * query():查询结果，将结果封装为JavaBean对象
           * query的参数：RowMapper
               * 一般我们使用BeanPropertyRowMapper实现类。可以完成数据到JavaBean的自动封装
               * new BeanPropertyRowMapper&lt;类型&gt;(类型.class)
       * queryForObject：查询结果，将结果封装为对象
           * 一般用于聚合函数的查询</code></pre><h3 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">			* 需求：</span></span><br><span class="line"><span class="comment">			4. 查询id为1的记录，将其封装为Map集合</span></span><br><span class="line"><span class="comment">			5. 查询所有记录，将其封装为List</span></span><br><span class="line"><span class="comment">			6. 查询所有记录，将其封装为Emp对象的List集合</span></span><br><span class="line"><span class="comment">			7. 查询总记录数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">			</span><br><span class="line">			<span class="keyword">import</span> cn.itcast.domain.Emp;</span><br><span class="line">			<span class="keyword">import</span> cn.itcast.utils.JDBCUtils;</span><br><span class="line">			<span class="keyword">import</span> org.junit.Test;</span><br><span class="line">			<span class="keyword">import</span> org.springframework.jdbc.core.BeanPropertyRowMapper;</span><br><span class="line">			<span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line">			<span class="keyword">import</span> org.springframework.jdbc.core.RowMapper;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">import</span> java.sql.Date;</span><br><span class="line">			<span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line">			<span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line">			<span class="keyword">import</span> java.util.List;</span><br><span class="line">			<span class="keyword">import</span> java.util.Map;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcTemplateDemo2</span> </span>&#123;</span><br><span class="line">			</span><br><span class="line">			    <span class="comment">//Junit单元测试，可以让方法独立执行			    </span></span><br><span class="line">			    <span class="comment">//1. 获取JDBCTemplate对象</span></span><br><span class="line">			    <span class="keyword">private</span> JdbcTemplate template = <span class="keyword">new</span> JdbcTemplate(JDBCUtils.getDataSource());</span><br><span class="line">			</span><br><span class="line">			    <span class="comment">/**</span></span><br><span class="line"><span class="comment">			     * 4.查询id为1001的记录，将其封装为Map集合</span></span><br><span class="line"><span class="comment">			     * 注意：这个方法查询的结果集长度只能是1</span></span><br><span class="line"><span class="comment">			     */</span></span><br><span class="line">			    <span class="meta">@Test</span></span><br><span class="line">			    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span></span>&#123;</span><br><span class="line">			        String sql = <span class="string">"select * from emp where id = ? or id = ?"</span>;</span><br><span class="line">			        Map&lt;String, Object&gt; map = template.queryForMap(sql, <span class="number">1001</span>,<span class="number">1002</span>);</span><br><span class="line">			        System.out.println(map);</span><br><span class="line">			        <span class="comment">//&#123;id=1001, ename=孙悟空, job_id=4, mgr=1004, joindate=2000-12-17, salary=10000.00, bonus=null, dept_id=20&#125;</span></span><br><span class="line">			</span><br><span class="line">			    &#125;</span><br><span class="line">			</span><br><span class="line">			    <span class="comment">/**</span></span><br><span class="line"><span class="comment">			     * 5. 查询所有记录，将其封装为List</span></span><br><span class="line"><span class="comment">			     */</span></span><br><span class="line">			    <span class="meta">@Test</span></span><br><span class="line">			    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">()</span></span>&#123;</span><br><span class="line">			        String sql = <span class="string">"select * from emp"</span>;</span><br><span class="line">			        List&lt;Map&lt;String, Object&gt;&gt; list = template.queryForList(sql);</span><br><span class="line">			</span><br><span class="line">			        <span class="keyword">for</span> (Map&lt;String, Object&gt; stringObjectMap : list) &#123;</span><br><span class="line">			            System.out.println(stringObjectMap);</span><br><span class="line">			        &#125;</span><br><span class="line">			    &#125;</span><br><span class="line">			</span><br><span class="line">			    <span class="comment">/**</span></span><br><span class="line"><span class="comment">			     * 6. 查询所有记录，将其封装为Emp对象的List集合</span></span><br><span class="line"><span class="comment">			     */</span></span><br><span class="line">			</span><br><span class="line">			    <span class="meta">@Test</span></span><br><span class="line">			    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test6</span><span class="params">()</span></span>&#123;</span><br><span class="line">			        String sql = <span class="string">"select * from emp"</span>;</span><br><span class="line">			        List&lt;Emp&gt; list = template.query(sql, <span class="keyword">new</span> RowMapper&lt;Emp&gt;() &#123;</span><br><span class="line">			</span><br><span class="line">			            <span class="meta">@Override</span></span><br><span class="line">			            <span class="function"><span class="keyword">public</span> Emp <span class="title">mapRow</span><span class="params">(ResultSet rs, <span class="keyword">int</span> i)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">			                Emp emp = <span class="keyword">new</span> Emp();</span><br><span class="line">			                <span class="keyword">int</span> id = rs.getInt(<span class="string">"id"</span>);</span><br><span class="line">			                String ename = rs.getString(<span class="string">"ename"</span>);</span><br><span class="line">			                <span class="keyword">int</span> job_id = rs.getInt(<span class="string">"job_id"</span>);</span><br><span class="line">			                <span class="keyword">int</span> mgr = rs.getInt(<span class="string">"mgr"</span>);</span><br><span class="line">			                Date joindate = rs.getDate(<span class="string">"joindate"</span>);</span><br><span class="line">			                <span class="keyword">double</span> salary = rs.getDouble(<span class="string">"salary"</span>);</span><br><span class="line">			                <span class="keyword">double</span> bonus = rs.getDouble(<span class="string">"bonus"</span>);</span><br><span class="line">			                <span class="keyword">int</span> dept_id = rs.getInt(<span class="string">"dept_id"</span>);</span><br><span class="line">			</span><br><span class="line">			                emp.setId(id);</span><br><span class="line">			                emp.setEname(ename);</span><br><span class="line">			                emp.setJob_id(job_id);</span><br><span class="line">			                emp.setMgr(mgr);</span><br><span class="line">			                emp.setJoindate(joindate);</span><br><span class="line">			                emp.setSalary(salary);</span><br><span class="line">			                emp.setBonus(bonus);</span><br><span class="line">			                emp.setDept_id(dept_id);</span><br><span class="line">			</span><br><span class="line">			                <span class="keyword">return</span> emp;</span><br><span class="line">			            &#125;</span><br><span class="line">			        &#125;);</span><br><span class="line">			        <span class="keyword">for</span> (Emp emp : list) &#123;</span><br><span class="line">			            System.out.println(emp);</span><br><span class="line">			        &#125;</span><br><span class="line">			    &#125;</span><br><span class="line">			</span><br><span class="line">			    <span class="comment">/**</span></span><br><span class="line"><span class="comment">			     * 6. 查询所有记录，将其封装为Emp对象的List集合</span></span><br><span class="line"><span class="comment">			     */</span></span><br><span class="line">			</span><br><span class="line">			    <span class="meta">@Test</span></span><br><span class="line">			    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test6_2</span><span class="params">()</span></span>&#123;</span><br><span class="line">			        String sql = <span class="string">"select * from emp"</span>;</span><br><span class="line">			        List&lt;Emp&gt; list = template.query(sql, <span class="keyword">new</span> BeanPropertyRowMapper&lt;Emp&gt;(Emp.class));</span><br><span class="line">			        <span class="keyword">for</span> (Emp emp : list) &#123;</span><br><span class="line">			            System.out.println(emp);</span><br><span class="line">			        &#125;</span><br><span class="line">			    &#125;</span><br><span class="line">			</span><br><span class="line">			    <span class="comment">/**</span></span><br><span class="line"><span class="comment">			     * 7. 查询总记录数</span></span><br><span class="line"><span class="comment">			     */</span></span><br><span class="line">			</span><br><span class="line">			    <span class="meta">@Test</span></span><br><span class="line">			    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test7</span><span class="params">()</span></span>&#123;</span><br><span class="line">			        String sql = <span class="string">"select count(id) from emp"</span>;</span><br><span class="line">			        Long total = template.queryForObject(sql, Long.class);</span><br><span class="line">			        System.out.println(total);</span><br><span class="line">			    &#125;</span><br><span class="line">			</span><br><span class="line">			&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/数据库/" rel="tag"># 数据库</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/09/18/工具/正则表达式/" rel="prev" title="正则表达式">
      <i class="fa fa-chevron-left"></i> 正则表达式
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/10/02/工具/数据结构和算法之美/" rel="next" title="数据结构和算法">
      数据结构和算法 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#MySql"><span class="nav-number">1.</span> <span class="nav-text">MySql</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库的基本概念"><span class="nav-number">1.1.</span> <span class="nav-text">数据库的基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL数据库软件"><span class="nav-number">1.2.</span> <span class="nav-text">MySQL数据库软件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL"><span class="nav-number">1.3.</span> <span class="nav-text">SQL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DDL-操作数据库、表"><span class="nav-number">1.3.1.</span> <span class="nav-text">DDL:操作数据库、表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#操作库"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">操作库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#操作表"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">操作表</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#添加约束"><span class="nav-number">1.3.1.2.1.</span> <span class="nav-text">添加约束</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DML：增删改表中数据"><span class="nav-number">1.3.2.</span> <span class="nav-text">DML：增删改表中数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DQL：查询表中的记录"><span class="nav-number">1.3.3.</span> <span class="nav-text">DQL：查询表中的记录</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#复杂查询"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">复杂查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多表查询"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">多表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#多表查询练习"><span class="nav-number">1.3.3.2.1.</span> <span class="nav-text">多表查询练习</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DCL：用户及其权限管理"><span class="nav-number">1.3.4.</span> <span class="nav-text">DCL：用户及其权限管理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库的设计"><span class="nav-number">1.4.</span> <span class="nav-text">数据库的设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#多表关系"><span class="nav-number">1.4.1.</span> <span class="nav-text">多表关系</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#案例"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">案例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据库设计的范式"><span class="nav-number">1.4.2.</span> <span class="nav-text">数据库设计的范式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#范例"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">范例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库的备份和还原"><span class="nav-number">1.5.</span> <span class="nav-text">数据库的备份和还原</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#事务"><span class="nav-number">1.6.</span> <span class="nav-text">事务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#异常解决"><span class="nav-number">1.7.</span> <span class="nav-text">异常解决</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#JDBC"><span class="nav-number">2.</span> <span class="nav-text">JDBC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#JDBC简单实现"><span class="nav-number">2.1.</span> <span class="nav-text">JDBC简单实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#抽取JDBC工具类-：-JDBCUtils"><span class="nav-number">2.2.</span> <span class="nav-text">抽取JDBC工具类 ： JDBCUtils</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JDBC控制事务："><span class="nav-number">2.3.</span> <span class="nav-text">JDBC控制事务：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库连接池"><span class="nav-number">2.4.</span> <span class="nav-text">数据库连接池</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-JDBC"><span class="nav-number">2.5.</span> <span class="nav-text">Spring JDBC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#练习"><span class="nav-number">2.5.1.</span> <span class="nav-text">练习</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">grandwarm</p>
  <div class="site-description" itemprop="description">这些年编程路上踩得坑</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">grandwarm</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  

</body>
</html>
